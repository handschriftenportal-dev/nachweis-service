/*
 * MIT License
 *
 * Copyright (c) 2023 Staatsbibliothek zu Berlin - Preu√üischer Kulturbesitz
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */

package de.staatsbibliothek.berlin.hsp.nachweis.infrastructure.kafka;

import static de.staatsbibliothek.berlin.hsp.messaging.activitystreams.api.model.enums.ActivityStreamsDokumentTyp.BESCHREIBUNG;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;

import de.staatsbibliothek.berlin.hsp.domainmodel.aggregates.Beschreibung;
import de.staatsbibliothek.berlin.hsp.mapper.tei.TEI2BeschreibungMapper;
import de.staatsbibliothek.berlin.hsp.messaging.activitystreams.api.model.ActivityStream;
import de.staatsbibliothek.berlin.hsp.messaging.activitystreams.api.model.ActivityStreamObject;
import de.staatsbibliothek.berlin.hsp.messaging.objectfactory.TEIObjectFactory;
import java.io.ByteArrayInputStream;
import java.util.List;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;
import org.tei_c.ns._1.TEI;

/**
 * Created by konrad.eichstaedt@sbb.spk-berlin.de on 06.06.2019.
 */

public class KafkaActivityStreamMessageDeserializerTest {

  private static final String JSON_KAFKA_MESSAGE_V1_0_3 = "{\n"
      + "  \"objects\": [\n"
      + "      {\n"
      + "        \"id\": null,\n"
      + "        \"groupId\": null,\n"
      + "        \"name\": null,\n"
      + "        \"version\": \"5.0\",\n"
      + "        \"compressed\": true,\n"
      + "        \"@type\": \"hspobject\",\n"
      + "        \"type\": \"BESCHREIBUNG\",\n"
      + "        \"url\": \"http://b-dev1047.pk.de:9296/import/job/7a5075d0-908f-403e-ae48-525fe618359a\",\n"
      + "        \"content\": \"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\"\n"
      + "      }\n"
      + "  ],\n"
      + "  \"actor\": {\n"
      + "    \"@type\": \"hspactor\",\n"
      + "    \"type\": null,\n"
      + "    \"id\": null,\n"
      + "    \"name\": \"Torsten Schassan\",\n"
      + "    \"url\": null\n"
      + "  },\n"
      + "  \"target\": {\n"
      + "    \"id\": \"17f29b9a-81f2-43eb-9499-6fb983b23509\",\n"
      + "    \"name\": \"tei-msDesc_Haertel.xml\",\n"
      + "    \"type\": null,\n"
      + "    \"@type\": \"hsptarget\"\n"
      + "  },\n"
      + "  \"@context\": null,\n"
      + "  \"id\": \"17f29b9a-81f2-43eb-9499-6fb983b23509\",\n"
      + "  \"action\": \"ADD\",\n"
      + "  \"@type\": \"hspmessage\",\n"
      + "  \"published\": null,\n"
      + "  \"summary\": null,\n"
      + "  \"version\": \"1.0\"\n"
      + "}\n";

  @Test
  public void test_GivenJSONByte_CreateActivityStreamMessage() throws Exception {

    KafkaActivityStreamMessageDeserializer deserializer = new KafkaActivityStreamMessageDeserializer();

    ActivityStream message = deserializer
        .deserialize("import", JSON_KAFKA_MESSAGE_V1_0_3.getBytes());

    assertNotNull(message);

    Assertions.assertEquals(1, message.getObjects().size());

    TEI2BeschreibungMapper mapper = new TEI2BeschreibungMapper();

    ActivityStreamObject activityStreamObject = message.getObjects().get(0);
    Assertions.assertEquals(BESCHREIBUNG, activityStreamObject.getType());
    List<TEI> teiList = TEIObjectFactory.unmarshal(new ByteArrayInputStream(activityStreamObject.getContent()));
    List<Beschreibung> beschreibungList = mapper.map(teiList.get(0));
    Assertions.assertEquals(1, beschreibungList.size());
    Beschreibung beschreibung = beschreibungList.get(0);

    assertNotNull(beschreibung.getId());

    beschreibung.getExterneIDs().stream().findFirst().ifPresent(r -> {
      assertEquals("mss_32-helmst_tei-msDesc_Haertel", r.getUrl());
    });
  }
}
